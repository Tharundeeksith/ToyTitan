window.nvpack=window.nvpack||{},window.nvpack.anal=function(){"use strict";class t{constructor(){this.document=window.document}set(t,i,s,n){var e=new Date((new Date).setHours(23,59,59,0));s=s||0==s?"expires="+s:"expires="+e,n=n?"domain=."+n:"",document.cookie=t+"="+i+"; "+s+"; "+n+"; path=/; secure"}get(t){for(var i=t+"=",s=document.cookie.split(";"),n=0;n<s.length;n++){var e=s[n].trim();if(0==e.indexOf(i))return e.substring(i.length,e.length)}return null}remove(t){document.cookie=t+"=; Max-Age=-99999999;"}lsSupport(){return!!window.localStorage}setLS(t,i){return this.lsSupport()&&localStorage.setItem(t,i)}getLS(t){return this.lsSupport()?localStorage.getItem(t):null}duration(t){var i=1,s="Fri, 31 Dec 1999 23:59:59 GMT";if(t)if(501==t)s="Fri, 31 Dec 1999 23:59:59 GMT";else if(0==t)s=0;else{500==t?i=365:t>0&&t<=90&&(i=t);var n=new Date;1!=i&&(i-=1,n.setTime(n.getTime()+24*i*60*60*1e3)),n.setHours(23,59,59,0),s=n}return s}}var i=()=>{var t,i,s=window.document,e=0;return{get:function(o,r,h,c){var a=-1!==o.indexOf("?")?"&":"?";r=r||{};var u=n();for(i in u&&Array.isArray(u)&&u.length>0&&(r.cookieData=u.join(";")),notify_visitors&&notify_visitors.cookie_domain&&(r.cookieDomain=notify_visitors.cookie_domain),r)r.hasOwnProperty(i)&&(a+=encodeURIComponent(i)+"="+encodeURIComponent(r[i])+"&");var d=h+ ++e;return window[d]=function(t){c(t);try{delete window[d]}catch(t){}window[d]=null},function(i){var n=s.createElement("script"),e=!1;n.src=i,n.async=!0,n.onload=n.onreadystatechange=function(){e||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(e=!0,n.onload=n.onreadystatechange=null,n&&n.parentNode&&n.parentNode.removeChild(n))},!t&&(t=s.getElementsByTagName("head")[0]),t.appendChild(n)}(o+a+"js_callback="+d),d},post:function(t,i,s,n,e){e.ajax({url:t,type:"POST",data:i,contentType:!1,processData:!1,success:n})}}},s=()=>(function(){if("function"==typeof window.CustomEvent)return!1;function t(t,i){i=i||{bubbles:!1,cancelable:!1,detail:null};var s=document.createEvent("CustomEvent");return s.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),s}t.prototype=window.Event.prototype,window.CustomEvent=t}(),{send:function(t,i){var s=new CustomEvent("notifyvisitors_callback",{detail:{data:t,url:document.location.href,type:i}});window.dispatchEvent(s)}}),n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[];if(document&&document.cookie){var s=document.cookie.split(";");"all"===t&&(i=s),Array.isArray(t)&&s&&s.length>0&&(i=s.filter((function(i){var s=i.trim().split("=")[0];return!!t.includes(s)||0===s.indexOf("_nv_")})))}return i},e="https://analytics.notifyvisitors.com/",o={event:e+"brand/t1/event",user:e+"brand/t1/users",dimensions:e+"brand/t1/dimensions",userSessions:e+"brand/t1/userSessions",collectSessions:e+"brand/t1/collectSessions"},r=new Date;class h{constructor(n){this.response={},this.session=n.data&&n.data.session||"",this.set_NV_UID=n.data&&n.data.set_NV_UID||"",this.config=this.config||{},this.data=this.data||{},this.bindEvent={bind:function(t,i,s,n){return n&&""!=n&&(window.notify_visitors.eventsRecord=window.notify_visitors.eventsRecord||{},window.notify_visitors.eventsRecord[n]=window.notify_visitors.eventsRecord[n]||[],window.notify_visitors.eventsRecord[n].push({n:i,e:t,c:s})),t.addEventListener?t.addEventListener(i,s):t.attachEvent?t.attachEvent("on"+i,s):void 0},unbind:function(t,i,s){return t.removeEventListener?t.removeEventListener(i,s):t.detachEvent?t.detachEvent("on"+i,s):void 0}},this.callbackNotifyEvent=s(),this.getJSONP=i(),this.callbackName="nv_anal_json",this.productName="analytics",this.cookieController=new t,this.checkAuth(n.Events.data),this.nvHandler}checkAuth(t,i){this.response=t,null!=t.auth&&(null!=t.async&&!1!==t.async?handleWindowLoad():this.init())}handleWindowLoad(){"complete"==document.readyState?this.init():this.bindEvent.bind(window,"load",init,this.productName)}init(){if(nvpack.config=nvpack.config||{},nvpack.config.a)return!1;nvpack.config.a=!0,nvpack.callbackNotifyEvent=this.callbackNotifyEvent,this.config.urls=o,this.data.auth=this.response.auth||{},this.data.setting=this.response.auth||{},this.data.auth.ruleData&&(this.data.setting.ruleData=this.data.auth.ruleData=this.response.ruleData),this.response.tokens&&(this.data.setting.tokens=this.data.auth.tokens=this.response.tokens),this.data.setting.trafficSource=this.data.auth.trafficSource=document.referrer,this.data.setting.isPwa=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches?1:0,this.data.setting.pageUrl=this.data.auth.pageUrl=document.location,this.data.setting.gmOffset=this.data.auth.gmOffset=60*r.getTimezoneOffset()*-1,this.data.setting.screenWidth=this.data.auth.screenWidth=screen.width,this.data.setting.screenHeight=this.data.auth.screenHeight=screen.height,this.data.setting.storage=this.data.auth.storage=this.browserStorage(),this.data.setting.linkreferrer=this.data.auth.linkreferrer=document.referrer,this.callbackNotifyEvent.send("analytics_init","loadscript"),this.load()}load(){var t=this;if("fail"==this.response.Authentication)return!1;this.nvHandler=function(i){var s=Array.prototype.slice.call(i);t.performEventActions(s)},this.nvStaticEvent=function(){var i=t.response.event_integration;Object.keys(i).forEach(s=>{void 0!==i[s].event_initialize_type&&0!=i[s].event_initialize_type?this.callStaticEventonClick(i[s].event_initialize_type,i[s].event,i[s].attributes,i[s].ltv,i[s].scope):t.eventAction(i[s].event,i[s].attributes,i[s].ltv,i[s].scope,1)})},t.response.event_integration&&this.nvStaticEvent()}callStaticEventonClick(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=this;if(i)var r=setInterval((function(){var h;if("X-Path"===t.type){if(!document.evaluate)return clearInterval(r),0;h=document.evaluate(t.value,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}else h="css"===t.type?document.querySelector(t.value):document.querySelector("#"+t.value);null!==h&&(clearInterval(r),h.addEventListener("click",(function(){o.eventAction(i,s,n,e,1)})))}),500)}performEventActions(t){if(!t[0])return!1;switch(t[0]){case"user":this.userAction(t[1],t[2]);break;case"pushuser":this.cookieController.get("_nv_push_subscribe")&&this.userAction(t[1],t[2]);break;case"event":this.eventAction(t[1],t[2],t[3],t[4]);break;case"pushevent":this.pusheventAction(t[1],t[2],t[3],t[4]);break;case"pushsubscribe":this.data.pushsubscribe.userID=t[1],this.data.pushsubscribe.event=t[2]}}userAction(t,i){if(t){var s=Object.assign({},this.data.setting);s.userID=t,i&&"object"==typeof i&&Object.keys(i).length&&(i.nvSegmentID||i.nvFormID||i.nvChannel)&&(i.nvSegmentID&&(s.segmentID=i.nvSegmentID,delete i.nvSegmentID),i.nvFormID&&(s.FormID=i.nvFormID,delete i.nvFormID),i.nvChannel&&(s.channel=i.nvChannel,delete i.nvChannel)),s.userParams=i?JSON.stringify(i):"",this.getJSONP.get(this.config.urls.user,s,this.callbackName,this.userActionResponse.bind(this))}}userActionResponse(t){t&&"object"==typeof t&&(t.campaignCookie&&this.session&&this.session(t.campaignCookie),t.nv_uid&&this.set_NV_UID&&this.set_NV_UID(t.nv_uid)),"object"==typeof t&&"success"==t.Authentication&&t.nv_uid&&(this.response.nv_uid!=t.nv_uid||t._nv_user_changed)&&(this.response.nv_uid=t.nv_uid,this.updateUserIdPushSubscribe(t)),t.callback_data&&this.callbackNotifyEvent.send(t.callback_data,"user")}updateUserIdPushSubscribe(t){window.notify_visitors.po&&window.notify_visitors.po.updateUserIdSubscription&&window.notify_visitors.po.updateUserIdSubscription(t.userID)}pusheventAction(t,i,s,n){this.cookieController.get("nv_push_subscribe")&&eventAction(t,i,s,n)}eventAction(t,i,s,n,e){if(t){var o=Object.assign({},this.data.setting);o.event_name=t,i&&(o.attributes=JSON.stringify(i)),s&&(o.ltv=s),n&&(o.scope=n),e&&(o.event_type=e),void 0!==this.data.pushsubscribe&&this.data.pushsubscribe.hasOwnProperty("userID")&&(o.userID=this.data.pushsubscribe.userID),this.getJSONP.get(this.config.urls.event,o,this.callbackName,this.eventActionResponse.bind(this))}}eventActionResponse(t){t.campaignCookie&&this.session&&this.session(t.campaignCookie),t.callback_data&&this.callbackNotifyEvent.send(t.callback_data,"event")}browserStorage(){var t={session:this.storage("sessionStorage"),local:this.storage("localStorage")};return JSON.stringify(t)}storage(t){var i={};return window[t]&&window[t].length>0&&Object.keys(window[t]).forEach((function(s){-1!==s.indexOf("_nv_")&&(i[s]=window[t][s])})),i}}var c=new h(window.notify_visitors);return h.nvHandler=c.nvHandler,h}();
